// Generated by CoffeeScript 1.10.0
(function() {
  "use strict";
  var $, Database, Game, Humano, Mosquito, error1, mainView, mosquito, myApp, unloadEvent,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  unloadEvent = function(e) {
    var confirmationMessage;
    confirmationMessage = "Você realmente deseja sair da página?";
    return (e || window.event).returnValue = confirmationMessage;
  };

  window.addEventListener("beforeunload", unloadEvent);

  try {
    myApp = new Framework7({
      material: true,
      pushState: true,
      swipePanel: 'left',
      swipePanelActiveArea: 56
    });
  } catch (error1) {
    alert("Ocorreu um erro no carregamento da página!\n Será atualizada.");
    window.location.reload();
  }

  $ = Dom7;

  mainView = myApp.addView('.view-main', {
    dynamicNavbar: true
  });

  Dom7.ajaxSetup({
    beforeSend: function() {
      return myApp.showIndicator();
    },
    complete: function() {
      return myApp.hideIndicator();
    }
  });

  Database = (function() {
    function Database() {
      this.name = "ZikaGame";
      this.version = "1.0";
      this.displayName = "ZikaGame";
      this.maxSize = 65536;
      this.db = openDatabase(this.name, this.version, this.displayName, this.maxSize);
    }

    Database.prototype.sqlExecute = function(query, func, parameters) {
      if (parameters == null) {
        parameters = null;
      }
      return this.db.transaction(function(transaction) {
        return transaction.executeSql(query, parameters, function(transaction, result) {
          return func(result);
        }, function(transaction, error) {
          return alert(error.message);
        });
      });
    };

    return Database;

  })();

  Game = (function(superClass) {
    extend(Game, superClass);

    function Game(paginaContent) {
      this.vida = 100;
      this.addVida(0);
      this.$window = $(window);
      this.pontosJogo = $(".modo-humano-page .pontos");
      this.loopGerarConteudo = null;
      if (paginaContent != null) {
        this.paginaContent = paginaContent;
      } else {
        alert("Deu Problema Sério");
      }
    }

    Game.prototype.addVida = function(qtde) {
      this.vida += qtde;
      $("#vida").text(this.vida);
      return this.vida;
    };

    Game.prototype.addPontos = function(pontos) {
      return this.pontosJogo.text(parseInt(this.pontosJogo.text()) + pontos);
    };

    Game.prototype.getPontos = function() {
      return parseInt(this.pontosJogo.text());
    };

    Game.prototype.randomTop = function(height) {
      var aleatorio;
      aleatorio = Math.random() * this.$window.height() + 56;
      if (aleatorio + height >= this.$window.height()) {
        return (this.$window.height() - height) + "px";
      } else {
        return aleatorio + "px";
      }
    };

    Game.prototype.randomLeft = function(width) {
      var aleatorio;
      aleatorio = Math.random() * this.$window.width();
      if (aleatorio + width >= this.$window.width()) {
        return (this.$window.width() - width) + "px";
      } else {
        return aleatorio + "px";
      }
    };

    return Game;

  })(Database);

  Mosquito = (function(superClass) {
    extend(Mosquito, superClass);

    function Mosquito() {
      return Mosquito.__super__.constructor.apply(this, arguments);
    }

    Mosquito.prototype.loop = null;

    Mosquito.prototype.aparecer = function(num) {
      var $this, mosquito, results;
      $this = this;
      results = [];
      while (num > 0 && this.addVida(0) > 0) {
        mosquito = null;
        mosquito = $('<img class="mosquito" src="img/mosquito.png">');
        mosquito.css('top', $this.randomTop(36));
        mosquito.css('left', $this.randomLeft(36));
        mosquito.on('mousedown touchstart', function(e) {
          e.preventDefault();
          return $this.morrer($(this));
        });
        $this.paginaContent.append(mosquito);
        $this.sumir(mosquito);
        results.push(num--);
      }
      return results;
    };

    Mosquito.prototype.sumir = function(mosquito) {
      return setTimeout((function(_this) {
        return function() {
          if (mosquito.parents('html').length === 1) {
            mosquito.remove();
            return _this.reproduzir();
          }
        };
      })(this), 2500);
    };

    Mosquito.prototype.morrer = function(mosquito) {
      this.addPontos(1);
      this.addVida(1);
      return mosquito.remove();
    };

    Mosquito.prototype.reproduzir = function() {
      this.aparecer(1);
      return this.infectar();
    };

    Mosquito.prototype.infectar = function() {
      if (this.addVida(-5) <= 0) {
        return this.gameOver();
      }
    };

    Mosquito.prototype.gerarInimigo = function() {
      return this.loop = setInterval((function(_this) {
        return function() {
          if (_this.getPontos() === 0) {
            return _this.aparecer(1);
          } else {
            return _this.aparecer(Math.ceil(_this.getPontos() * 1.01 / 10));
          }
        };
      })(this), 2500);
    };

    Mosquito.prototype.gameOver = function(obj) {
      mainView.router.load({
        url: "game-over.html"
      });
      return clearInterval(this.loop);
    };

    return Mosquito;

  })(Game);

  Humano = (function(superClass) {
    extend(Humano, superClass);

    function Humano() {
      return Humano.__super__.constructor.apply(this, arguments);
    }

    Humano.prototype.aparecer = function() {};

    Humano.prototype.sumir = function() {};

    Humano.prototype.morrer = function() {};

    Humano.prototype.proteção = function() {};

    return Humano;

  })(Game);

  mosquito = null;

  myApp.onPageInit("modo-humano", function(page) {
    mosquito = null;
    mosquito = new Mosquito($(".modo-humano"));
    return mosquito.gerarInimigo();
  });

  myApp.onPageInit("game-over", function() {
    return mosquito = null;
  });

  myApp.onPageBeforeRemove("modo-humano", function(page) {
    return mosquito = null;
  });

}).call(this);

//# sourceMappingURL=Game.js.map
